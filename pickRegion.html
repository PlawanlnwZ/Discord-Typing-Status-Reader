<!DOCTYPE html>
<html>
<head>
<style>
body { margin:0; cursor: crosshair; user-select: none; background: rgba(0,0,0,0.01); }
#rect { position: absolute; border: 2px dashed red; display: none; }
</style>
</head>
<body>
<div id="rect"></div>
<script>
let startX, startY;
let rect = document.getElementById('rect');

document.body.addEventListener('mousedown', (e) => {
    startX = e.clientX;
    startY = e.clientY;
    rect.style.left = startX + 'px';
    rect.style.top = startY + 'px';
    rect.style.width = '0px';
    rect.style.height = '0px';
    rect.style.display = 'block';
});

document.body.addEventListener('mousemove', (e) => {
    if (!startX) return;
    const width = e.clientX - startX;
    const height = e.clientY - startY;
    rect.style.width = Math.abs(width) + 'px';
    rect.style.height = Math.abs(height) + 'px';
    rect.style.left = (width < 0 ? e.clientX : startX) + 'px';
    rect.style.top = (height < 0 ? e.clientY : startY) + 'px';
});

document.body.addEventListener('mouseup', (e) => {
    const left = parseInt(rect.style.left);
    const top = parseInt(rect.style.top);
    const width = parseInt(rect.style.width);
    const height = parseInt(rect.style.height);

    // send picked region to main via postMessage
    window.opener.postMessage({ left, top, width, height }, '*');
    window.close();
});
</script>
</body>
</html>
